<!DOCTYPE html>
<html lang="en"><head>
<script src="chap02_files/libs/clipboard/clipboard.min.js"></script>
<script src="chap02_files/libs/quarto-html/tabby.min.js"></script>
<script src="chap02_files/libs/quarto-html/popper.min.js"></script>
<script src="chap02_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="chap02_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="chap02_files/libs/quarto-html/light-border.css" rel="stylesheet">
<link href="chap02_files/libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="chap02_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.5.57">

  <title>chap02</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="chap02_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="chap02_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
  </style>
  <link rel="stylesheet" href="chap02_files/libs/revealjs/dist/theme/quarto.css">
  <link rel="stylesheet" href="lecture-theme.css">
  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css">
  <link href="chap02_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="chap02_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="chap02_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="chap02_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-titled.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-titled) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-titled.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-titled .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-titled .callout-title  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-titled.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-titled.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-title {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-title {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-title {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-titled .callout-body > .callout-content > :last-child {
    padding-bottom: 0.5rem;
    margin-bottom: 0;
  }

  .callout.callout-titled .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-titled) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-title {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-title {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-title {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-title {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-title {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">


<section class="slide level0">

<h1><span class="header-section-number">2</span> Particle Acceleration at Shock Waves</h1>
</section>
<section class="slide level0">

<h2><span class="header-section-number">2.1</span> Introduction</h2>
<ul>
<li>Space is filled with particles with energies orders of magnitude higher than we normally expect.</li>
<li>How are they generated and what role do they possibly play in the dynamics?</li>
</ul>
<p><img data-src="figures/soho.png" height="500"></p>
</section>
<section class="slide level0">

<h3 data-number="2.1.1" id="nonthermal-particle-distribution"><span class="header-section-number">2.1.1</span> Nonthermal Particle Distribution</h3>
<ul>
<li>Particle energy distribution in space is not in thermodynamic equilibrium. The energy equipartition law does not seem to be satisfied.</li>
<li>A power-law type energy distribution is commonly seen both in natural and social systems.</li>
</ul>
<div class="columns">
<div class="column" style="width:50%;">
<p><img data-src="figures/cosmic-ray-spectrum.png" height="500"></p>
</div><div class="column" style="width:50%;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="figures/corporate-income.png" height="500"></p>
<figcaption>経済物理学の発見（高安秀樹）</figcaption>
</figure>
</div>
</div></div>
</section>
<section class="slide level0">

<h3 data-number="2.1.2" id="major-particle-acceleration-mechanisms"><span class="header-section-number">2.1.2</span> Major Particle Acceleration Mechanisms</h3>
<ul>
<li>Shock Waves
<ul>
<li>The bulk flow kinetic energy is converted to the thermal energy.</li>
<li>The “standard model” for the cosmic-ray acceleration.</li>
</ul></li>
<li>Magnetic Reconnection
<ul>
<li>The magnetic energy is converted to the particle kinetic and thermal energies.</li>
<li>Various mechanisms have been proposed and discussed, although not that mature as compared to the shock acceleration.</li>
</ul></li>
<li>Turbulence
<ul>
<li>The turbulent energy is converted to the thermal energy.</li>
<li>Often invoked as a possible particle acceleration mechanism.</li>
</ul></li>
</ul>
<p>Many of the elementary physical processes are common in all of these applications.</p>
</section>
<section class="slide level0">

<h3 data-number="2.1.3" id="examples"><span class="header-section-number">2.1.3</span> Examples</h3>
<h4 id="solar-energetic-particles-solar-cosmic-ray">Solar Energetic Particles (Solar Cosmic Ray)</h4>
<p><img data-src="figures/solar-energetic-particle.png" height="600"></p>
</section>
<section class="slide level0">

<h4 id="cosmic-ray-acceleration-at-supernova-remnant-shocks">Cosmic-ray Acceleration at Supernova Remnant Shocks</h4>
<p><img data-src="figures/supernova-remnant.png" height="500"></p>
</section>
<section class="slide level0">

<h2><span class="header-section-number">2.2</span> Diffusive Shock Acceleration</h2>
<h3 data-number="2.2.1" id="box-model"><span class="header-section-number">2.2.1</span> Box Model</h3>
<p>Consider the energy spectrum in a spatially integrated box: <span class="math display">
\frac{\partial}{\partial t} N(E) +
\frac{\partial}{\partial E}
\left( \frac{E}{\tau_{\rm acc}} N(E) \right) = -
\frac{N(E)}{\tau_{\rm esc}}
</span> with the typical acceleration time <span class="math inline">\tau_{\rm acc}^{-1} \equiv (d E / d t)/E</span>.</p>
<p>In the simplest case where both the acceleration and escape times are energy-independent, the steady-state solution is given by <span class="math display">
N(E) = N_0 \left( \frac{E}{E_0} \right)^{-q}
\quad
q \equiv 1 + \frac{\tau_{\rm acc}}{\tau_{\rm esc}}.
</span> If the time scales are energy-dependent, the spectrum is not a power-law in general. A physically important quantity is the flux of particles escaping from the system, which is given by <span class="math display">
\frac{\partial \ln (N/\tau_{\rm esc})}{\partial \ln E} = -
\left(
  1 + \frac{\tau_{\rm acc}}{\tau_{\rm esc}} + \frac{\partial \ln (\tau_{\rm acc}/\tau_{\rm esc})}{\partial \ln E}
\right),
</span> which gives a power-law only when the ratio between the two time scales is constant. Therefore, understanding a particle acceleration mechanism to produce a power-law spectrum is essentially to find a specific physical process that gives the acceleration time <span class="math inline">\tau_{\rm acc}</span> and the escape time <span class="math inline">\tau_{\rm esc}</span>.</p>
</section>
<section class="slide level0">

<h3 data-number="2.2.2" id="second-order-fermi-acceleration"><span class="header-section-number">2.2.2</span> Second-order Fermi Acceleration</h3>
<p>The original idea by Fermi was to consider cosmic rays colliding with molecular clouds. We consider a little more general particle acceleration via random collisions with moving magnetic obstacles.</p>
<p>The conservation of energy in the rest frame of the obstacle (moving with a speed <span class="math inline">V</span> in the observer’s frame) indicates that the particle energy gain per collision is given by: <span class="math display">
\frac{\Delta E}{E} \sim 2 \frac{V}{c} \cos \theta,
</span> where <span class="math inline">\theta</span> is the angle between the velocities of the particle and the obstacle. Note that we consider that highly relativistic particles <span class="math inline">v \sim c</span>.</p>
<p>Averaging over <span class="math inline">\theta</span> indicates that there is no net energy gain for the particles.</p>

<img data-src="figures/second-order-fermi.png" class="r-stretch quarto-figure-center"><p class="caption">height:280px center</p></section>
<section class="slide level0">

<h4 id="mean-energy-gain">Mean Energy Gain</h4>
<p>Typical time scale for cosmic-ray collision with the obstacle is <span class="math display">
\tau_{c} \sim \frac{\lambda_c}{v + V \cos \theta} \quad
\text{(non-relativistic)}
</span> The probability of collision is proportional to <span class="math inline">1/\tau_{c}</span> and <span class="math display">
P_{c} \propto \frac{1}{\tau_c} \propto (v + V \cos \theta),
</span> and is dependent on <span class="math inline">\theta</span>. Therefore, head-on collisions occur more frequently than overtaking collisions, leading to a finite net energy gain even averaged over <span class="math inline">\theta</span>.</p>
<p>The expectation for the energy gain is <span class="math display">
\begin{aligned}
\left&lt; \frac{\Delta E}{E} \right&gt;
&amp;=
\frac
    {\displaystyle \int_{-1}^{+1} \frac{\Delta E}{E} \mu (1 + \frac{V}{c} \mu) d \mu}
    {\displaystyle \int_{-1}^{+1} \mu (1 + \frac{V}{c} \mu) d \mu}
    \qquad \mu = \cos \theta
    \\
&amp;= \frac{2}{3} \left( \frac{V}{c} \right)^2,
\end{aligned}
</span> which is second order in <span class="math inline">V/c</span>. Particles in magnetic turbulence will continuously gain energy in a stochastic manner.</p>
</section>
<section class="slide level0">

<h4 id="acceleration-time">Acceleration Time</h4>
<p>The acceleration time may be estimated as <span class="math display">
\frac{1}{\tau_{\rm acc}}
\sim \left( \frac{1}{\tau_{c}} \frac{\Delta E}{E} \right)
\sim \frac{2}{3} \frac{V^2}{\lambda_c c},
</span> where <span class="math inline">\tau_{c}</span> is the mean collision time and <span class="math inline">\lambda_{c} \sim c \tau_{c}</span> is the mean free path. This indicates that the acceleration time is independent of energy.</p>
<p>If we <em>assume</em> that <span class="math inline">\tau_{\rm esc}</span> is also independent of energy, the power-law spectrum is obtained with its index given by <span class="math inline">q = \tau_{\rm acc}/\tau_{\rm esc} + 1</span>. Otherwise, the spectrum is not a power-law in general.</p>
<h4 id="issues">Issues</h4>
<ol type="1">
<li>The spectral index is highly dependent on the free parameter <span class="math inline">\tau_{\rm esc}</span>. Furthermore, if <span class="math inline">\tau_{\rm esc}</span> is energy dependent (e.g., diffusive escape from the system), the power-law spectrum cannot be reproduced.</li>
<li>The original Fermi’s idea considering cosmic-ray acceleration in interstellar turbulence (the velocity of molecular clouds <span class="math inline">V \sim 10 \, {\rm km/s}</span> and the inter-cloud distance <span class="math inline">\lambda_{c} \sim 1 \, {\rm pc}</span>) indicates that <span class="math inline">\tau_{\rm acc} \sim 6 \times 10^{16} {\rm s} \sim 2 \times 10^{9} {\rm yrs}</span>, which is probably too slow (cf., typical p-p collision loss time: <span class="math inline">\sim 10^{15} \, {\rm s}</span>, cosmic age: <span class="math inline">\sim 4 \times 10^{17} \, {\rm s}</span>.)</li>
</ol>
</section>
<section class="slide level0">

<h3 data-number="2.2.3" id="first-order-fermi-acceleration"><span class="header-section-number">2.2.3</span> First-order Fermi Acceleration</h3>
<p>The first-order Fermi acceleration has been the standard model for the shock acceleration of cosmic rays. The particles gain energy by repeatedly crossing the shock front back and force for many times.</p>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="figures/scholer.png" height="350"></p>
<figcaption>Courtesy by M. Scholer</figcaption>
</figure>
</div>
<h4 id="assumptions">Assumptions</h4>
<ul>
<li>The shock is a discontinuous jump in the fluid velocity in the hydrodynamics sense.</li>
<li>Magnetic irregularities exist both in the upstream and downstream and are convected by the fluid flows.</li>
</ul>
</section>
<section class="slide level0">

<h4 id="mean-energy-gain-1">Mean energy gain</h4>
<p>Consider a relativistic particle with the velocity vector forming an angle <span class="math inline">\theta</span> with respect to the shock normal (pointing toward downstream). The energy gain via a single scattering by an irregularity moving with the velocity <span class="math inline">V</span> parallel to the shock normal is given by <span class="math display">
\frac{\Delta E}{E} \approx 2 \frac{V}{c} \cos \theta.
</span> Since we consider the scattering by irregularities moving with the background flow, its velocity is either <span class="math inline">V = V_1</span> (upstream) or <span class="math inline">V = V_2</span> (downstream).</p>
<p>The energy gain per one cycle (i.e., downstream → upstream → downstream) is given by <span class="math display">
\frac{\Delta E}{E} \approx
\underbrace{2 \frac{V_1}{c} \cos \theta_{+}}_
{\rm upstream \, \cos \theta_{+}&gt;0} +
\underbrace{2 \frac{V_2}{c} \cos \theta_{-}}_
{\rm downstream \, \cos \theta_{-}&lt;0}
</span> where <span class="math inline">\theta_{+}</span> and <span class="math inline">\theta_{-}</span> are the incident angles for crossing the shock front from upstream to downstream and from downstream to upstream, respectively.</p>
</section>
<section class="slide level0">

<p>Considering the number of particles with a pitch angle of <span class="math inline">\theta_{+}</span> is proportional to <span class="math inline">\cos \theta_{+}</span> (i.e., the number flux of particles crossing the shock front <span class="math inline">\propto \cos \theta_{+}</span>), the expectation for <span class="math inline">\cos \theta_{+}</span> is obtained as <span class="math display">
\left&lt; \cos \theta_{+} \right&gt; =
\underbrace{2}_{\textrm{normalization}}
\int_{0}^{\pi/2} \cos \theta_{+} \,\,
\underbrace{\cos \theta_{+}}_{\textrm{flux}} \,\,
\underbrace{\sin \theta_{+}}_{\textrm{Jacobian}} d \theta_{+} =
2 \int_{0}^{1} \mu^2 d \mu = \frac{2}{3}.
</span> The exactly same argument gives <span class="math inline">\left&lt; \cos \theta_{-} \right&gt; = -2/3</span>.</p>
<p>Therefore, the mean energy gain per one cycle is given by <span class="math display">
\left&lt; \frac{\Delta E}{E} \right&gt; \approx \frac{4}{3} \frac{V_1 - V_2}{c},
</span> which is first order in <span class="math inline">V/c</span>. In contrast to the second-order Fermi mechanism, the first-order contribution remains finite because of the systematic jump in the flow velocity across the shock front (i.e., <span class="math inline">V_1 \neq V_2</span>). The positive energy gain <span class="math inline">\Delta E &gt; 0</span> is a consequence of the compression at the hydrodynamic shock.</p>
</section>
<section class="slide level0">

<h4 id="spectral-index">Spectral Index</h4>
<p>The mean particle energy after <span class="math inline">l</span> cycle: <span class="math display">
\left&lt; E_{l+1} \right&gt; = \left&lt; E_{l} \right&gt;
\left( 1 + \frac{4}{3} \frac{V_1 - V_2}{c} \right)
\quad \rightarrow \quad
\left&lt; E_{l} \right&gt; = \left&lt; E_{0} \right&gt;
\left( 1 + \frac{4}{3} \frac{V_1 - V_2}{c} \right)^{l}
</span> The angle blacket <span class="math inline">\left&lt; \right&gt;</span> will be omitted henceforth.</p>
<p>Let us consider the escape probability of particles from the system. The escape probability per cycle in the downstream is given by: <span class="math display">
\begin{aligned}
P_{\rm esc} &amp;=
\frac{\text{flux toward far downstream}}{\text{flux from upstream to downstream}}
\\
&amp;=
\frac
{\displaystyle N V_2}
{\displaystyle \frac{1}{4\pi}
\int_{0}^{2\pi} d \phi
  \int_{0}^{\pi/2} \sin\theta d \theta \, N c \cos\theta}
= \frac{4 V_2}{c}.
\end{aligned}
</span> Note that we ignore the particle escape toward far upstream.</p>
</section>
<section class="slide level0">

<p>The probability that a particle remains in the vicinity of the shock after <span class="math inline">l</span> cycle is given by <span class="math inline">P_{l} = (1 - P_{\rm esc})^{l} = \left( 1 - \frac{4 V_2}{c} \right)^{l}</span>.</p>
<p>This probability may be related to the energy spectrum as follows: <span class="math display">
P_{l} =
\frac{\text{number of particles with} \, E \geq E_{l}}{\text{total number of particles}}
=
\frac
{\int_{E_l}^{\infty} N(E') dE'}
{\int_{0}^{\infty} N(E') dE'}
\quad \rightarrow \quad
N(E) \propto \frac{d P_{l} (E)}{d E},
</span> where <span class="math inline">N(E) dE</span> is the number of particle in the energy interval: <span class="math inline">E \sim E + dE</span>.</p>
<p>The relationship between <span class="math inline">P_l</span> and <span class="math inline">E_l</span> is obtained as follows <span class="math display">
\frac
{\ln \left( E_l/E_0 \right) }
{\ln P_l}
=
\frac
{\ln \left( 1 + \frac{4}{3} \frac{V_1 - V_2}{c} \right) }
{\ln \left( 1 - \frac{4 V_2}{c} \right) }
\approx
\frac
{\frac{4}{3} \frac{V_1 - V_2}{c}}
{-\frac{4 V_2}{c}}
= -\frac{V_1 - V_2}{3 V_2}
\quad \rightarrow \quad
P_l \approx \left( \frac{E_l}{E_0} \right)^{\frac{-3 V_2}{V_1 - V_2}}.
</span></p>
</section>
<section class="slide level0">

<p>Assuming <span class="math inline">N(E) \propto E^{-q}</span>, we obtain <span class="math display">
q = \frac{3 V_2}{V_1 - V_2} + 1 = \frac{V_1 + 2 V_2}{V_1 - V_2} = \frac{r + 2}{r - 1}
</span> where <span class="math inline">r = V_1/V_2</span> is the shock compression ratio.</p>
<ul>
<li>Since <span class="math inline">r \rightarrow 4</span> at a strong shock with the specific heat ratio <span class="math inline">\gamma = 5/3</span>, we obtain a universal spectral form: <span class="math inline">q \rightarrow 2</span>.</li>
<li>The spectral index does not depend details of scattering/turbulence properties and simply determined by the hydrodynamics of the background fluid.</li>
<li>The canonical spectrum <span class="math inline">q = 2</span> is close to (but not exactly the same as) the observed cosmic ray spectral index when taken into account a spectral steepening (via diffusive escape) during propagation from the source to the observer.</li>
</ul>
</section>
<section class="slide level0">

<h3 data-number="2.2.4" id="random-walk-and-diffusion-in-space"><span class="header-section-number">2.2.4</span> Random Walk and Diffusion in Space</h3>
<p>Particles randomly scattered by turbulence perform random walk. The simplest model considers particles moving with a speed <span class="math inline">c</span> either in positive or negative directions change its direction randomly every <span class="math inline">\tau_{c}</span>. The resulting particle distribution is described by the binomial distribution. After <span class="math inline">n = t/\tau_{c}</span> scatterings, we have</p>
<ul>
<li>mean: <span class="math inline">\left&lt; \Delta x \right&gt; = 0</span></li>
<li>variance: <span class="math inline">\left &lt; \Delta x^2 \right&gt; = n \lambda_{c}^2 = \frac{t}{\tau_c} (c \tau_{c})^2 \equiv 2 \kappa t, \,</span> where <span class="math inline">\kappa</span> is the diffusion coefficient.</li>
</ul>
<p>Since the turbulence is convected by the background plasma flow <span class="math inline">V</span>, the total particle transport should obey the diffusion-convection equation: <span class="math display">
\frac{\partial f}{\partial t} + V \frac{\partial f}{\partial x} =
\frac{\partial}{\partial x} \left( \kappa \frac{\partial f}{\partial x} \right).
</span></p>
<p>The steady-state solution is given by <span class="math display">
f(x) = A \exp \left(\frac{x}{\kappa/V} \right) + B,
</span> where <span class="math inline">A</span> and <span class="math inline">B</span> are integration constants to be determined by the boundary condition. This indicates that the typical length scale is given by <span class="math inline">l_{\rm diff} = \kappa / V</span>, which is called the diffusion length.</p>
</section>
<section class="slide level0">

<h3 data-number="2.2.5" id="adiabatic-energy-gain"><span class="header-section-number">2.2.5</span> Adiabatic Energy Gain</h3>
<p>It is possible to show that the momentum gain of particles in a finite flow divergence <span class="math inline">\nabla \cdot \boldsymbol{V} \neq 0</span> is given by <span class="math display">
\frac{1}{p} \frac{d p}{d t} = -
\frac{1}{3} \nabla \cdot \boldsymbol{V}
</span> for both relativistic and non-relativistic particles.</p>
<p>We then finally obtain the following diffusion-convection equation: <span class="math display">
\frac{\partial}{\partial t} f +
V \frac{\partial}{\partial x} f -
\frac{1}{3} \frac{\partial V}{\partial x} \frac{\partial f}{\partial \ln p}=
\frac{\partial}{\partial x}
\left[ \kappa \frac{\partial}{\partial x} f \right],
</span> which describes the transport of energetic particles in a turbulent plasma.</p>
</section>
<section class="slide level0">

<h3 data-number="2.2.6" id="steady-state-solution-at-discontinuous-shock-waves"><span class="header-section-number">2.2.6</span> Steady-state Solution at Discontinuous Shock Waves</h3>
<p>Consider the simplest case where the diffusion coefficient is spatially constant in the upstream and downstream regions <span class="math display">
V =
\begin{cases}
&amp; V_1 \quad &amp; \text{for} \quad x &lt; 0
\\
&amp; V_2 \quad &amp; \text{for} \quad x &gt; 0
\end{cases}
\quad \quad \text{and} \quad \quad
\kappa =
\begin{cases}
&amp; \kappa_1 (p) \quad &amp; \text{for} \quad x &lt; 0
\\
&amp; \kappa_2 (p) \quad &amp; \text{for} \quad x &gt; 0
\end{cases}
</span></p>
<p>We take the boundary condition such that <span class="math inline">f \rightarrow 0</span> for <span class="math inline">x \rightarrow - \infty</span> (far upstream), and <span class="math inline">\partial f/\partial x \rightarrow 0</span> for <span class="math inline">x \rightarrow + \infty</span> (far downstream). We can then write the solution as follows: <span class="math display">
f(x, p) =
\begin{cases}
&amp; A_1(p) \exp \left( \frac{x}{\kappa_1/V_1} \right) \quad &amp; \text{for} \quad x &lt; 0
\\
&amp; A_2(p) \quad &amp; \text{for} \quad x &gt; 0
\end{cases},
</span> where <span class="math inline">A_1(p)</span> and <span class="math inline">A_2(p)</span> are momentum-dependent functions yet to be determined. By further imposing the continuity of the distribution function at the shock front, we see that <span class="math inline">A_1(p) = A_2(p) \equiv f_0 (p)</span>.</p>
</section>
<section class="slide level0">

<p>Let us consider a yet another boundary condition by taking the integral of the diffusion-convection equation across the shock front: <span class="math display">
\lim_{\epsilon \rightarrow 0} \int_{-\epsilon}^{+\epsilon}
\left[
  V \frac{\partial f}{\partial x} -
  \frac{1}{3} \frac{\partial V}{\partial x} \frac{\partial f}{\partial \ln p} -
  \frac{\partial}{\partial x} \left( \kappa \frac{\partial f}{\partial x} \right)
\right] dx = 0,
\\
\Rightarrow
- \frac{1}{3} (V_2 - V_1) \frac{\partial f}{\partial \ln p}
\Bigg|_{x=0} -
\left[
  \kappa \frac{\partial f}{\partial x}
\right]_{-0}^{+0} = 0.
</span></p>
<p>We then immediately obtain <span class="math display">
\ln f_0(p) = - \frac{3 V_1}{V_1 - V_2} \ln p,
</span> or <span class="math display">
f_0(p) \propto p^{\displaystyle - \frac{3 r}{r - 1}}
\quad \text{where} \quad r = V_1/V_2.
</span> For relativistic particles <span class="math inline">E \sim p</span>, we have <span class="math display">
N(E) \propto 4 \pi p^2 f_0(p) \propto E^{-q} \quad \text{with} \quad q = \frac{r + 2}{r - 1},
</span> which is consistent with the result obtained based on the single particle picture.</p>
</section>
<section class="slide level0">

<h3 data-number="2.2.7" id="acceleration-time-1"><span class="header-section-number">2.2.7</span> Acceleration time</h3>
<p>The upstream and downstream particle residence times during particle acceleration may be estimated as <span class="math display">
\tau_{1} \sim \frac{2 \kappa_1/V_1}{c/2} = 4 \frac{\kappa_1}{V_1 c},
\quad \quad
\tau_{2} \sim \frac{2 \kappa_2/V_2}{c/2} = 4 \frac{\kappa_2}{V_2 c},
</span> where numerical factors are introduced so that the result agrees with more rigorous treatment.</p>
<p>The acceleration time is estimated accordingly <span class="math display">
\tau_{\rm acc}
\sim \left( \frac{1}{E} \frac{d E}{d t} \right)^{-1}
\sim \left( \frac{1}{\tau_{1} + \tau_{2}} \frac{\Delta E}{E} \right)^{-1}
\sim \frac{3}{V_1 - V_2} \left( \frac{\kappa_1}{V_1} + \frac{\kappa_2}{V_2} \right).
</span></p>
<p>Notice that the escape time may also be estimated by <span class="math display">
\tau_{\rm esc} \sim \frac{1}{V_2} \left( \frac{\kappa_1}{V_1} + \frac{\kappa_2}{V_2} \right),
</span> which gives the spectral index <span class="math display">
q = 1 + \frac{\tau_{\rm acc}}{\tau_{\rm esc}} = \frac{r + 2}{r - 1}.
</span> This confirms that the idea of the box model applies to the shock acceleration problem as well.</p>
</section>
<section class="slide level0">

<h3 data-number="2.2.8" id="maximum-energy"><span class="header-section-number">2.2.8</span> Maximum energy</h3>
<p>The acceleration time explicitly depends on the diffusion coefficient, which is not easily be estimated in general.</p>
<p>To proceed further, we use a phenomenological “Bohm-like” diffusion coefficient: <span class="math display">
\kappa_1 = \kappa_2 = \frac{1}{3} \lambda_{\rm mfp} c
\quad \text{with} \quad
\lambda_{\rm mfp} = \xi r_g,
</span> where <span class="math inline">r_g = \gamma m c/ Z e B</span> is the gyroradius and <span class="math inline">\xi</span> is called a Bohm-factor. The most optimistic case <span class="math inline">\xi = 1</span> is called the Bohm limit.</p>
<p>Assuming that the particle acceleration continues during the life time <span class="math inline">T \sim \tau_{\rm acc}</span> of the shock, the maximum energy may be estimated as <span class="math display">
E_{\rm max} \sim
\frac{20}{3} \frac{Z e B V_1^2 T}{\xi}
\sim \frac{3}{20 \xi}
\,\, Z e
\underbrace{\bigg( \frac{V_1}{c} B \bigg)}_{E}
\,\,
\underbrace{\bigg( V_1 T \bigg)}_{L}.
</span></p>
<p>Note that the estimate is written in a form: (charge) <span class="math inline">\times</span> (electric field) <span class="math inline">\times</span> (distance).</p>
</section>
<section class="slide level0">

<h3 data-number="2.2.9" id="application-to-supernova-remnants"><span class="header-section-number">2.2.9</span> Application to Supernova Remnants</h3>
<p>The maximum energy by the first-order Fermi acceleration at SNR shocks is smaller than the knee energy (<span class="math inline">\sim 10^{15.5}</span> eV) by at least one order of magnitude. <span class="math display">
E_{\rm max} \sim
1.2 \times 10^{14} \,
\left( \frac{1}{\xi} \right)
\left( \frac{V_1}{3000 \, {\rm km/s}} \right)^{2}
\left( \frac{B}{10 \, {\rm \mu G}} \right)
\left( \frac{t}{3000 \, {\rm yrs}} \right)
\, \text{[eV]}
</span></p>
<p><img data-src="figures/snr-shock.png" height="450"></p>
</section>
<section class="slide level0">

<h3 data-number="2.2.10" id="application-to-coronal-shocks-ground-level-enhancement"><span class="header-section-number">2.2.10</span> Application to Coronal Shocks (Ground Level Enhancement)</h3>
<p>Solar protons of GeV energies cause the so-called Ground Level Enhancements (GLEs) measured at Earth. GLEs seem to be produced by a shock wave propagating near the sun. The maximum energy may be estiamted as: <span class="math display">
E_{\rm max} \sim
0.9 \times 10^{9} \,
\left( \frac{1}{\xi} \right)
\left( \frac{V_1}{1000 \, {\rm km/s}} \right)^{2}
\left( \frac{B}{0.1 \, {\rm G}} \right)
\left( \frac{t}{600 \, {\rm s}} \right)
\, \text{[eV]}
</span></p>
<p><img data-src="figures/gle-coronal-shock.png" height="450"></p>
</section>
<section class="slide level0">

<h3 data-number="2.2.11" id="possible-origins-of-cosmic-rays-in-the-universe"><span class="header-section-number">2.2.11</span> Possible Origins of Cosmic Rays in the Universe</h3>
<p>Since the maximum energy obtained by DSA is proportional to <span class="math inline">V B L</span> (shock speed, magnetic field, and system size), we can consider that objects with large magnetic field strength and system size are possible sources of cosmic rays in the universe.</p>
<p><img data-src="figures/hillas-diagram.png" height="500"></p>
</section>
<section class="slide level0">

<h2><span class="header-section-number">2.3</span> Pitch-angle Scattering and Spatial Diffusion</h2>
<h3 data-number="2.3.1" id="alfvenic-waves"><span class="header-section-number">2.3.1</span> Alfvenic Waves</h3>
<p>Let us consider a charged-particle with a charge of <span class="math inline">q</span> and a mass of <span class="math inline">m</span> interacting with a circularly polarized parallel propagating Alfven wave, which is given by <span class="math display">
\begin{cases}
&amp; B_x =+ B_w \cos ( k z - \omega t )
\\
&amp; B_y =- B_w \sin ( k z - \omega t)
\\
&amp; B_z = B_0
\end{cases}
, \quad
\begin{cases}
&amp; E_x =+ \frac{\omega}{k c} B_y
\\
&amp; E_y =- \frac{\omega}{k c} B_x
\\
&amp; E_z = 0
\end{cases}
.
</span> This is an exact solution for MHD equations even with a finite amplitude. We define the phase of the wave by <span class="math inline">\psi = k z - \omega t</span>.</p>
<p><img data-src="figures/circularly-polarized-wave.png" height="350"></p>
</section>
<section class="slide level0">

<h3 data-number="2.3.2" id="cyclotron-resonance"><span class="header-section-number">2.3.2</span> Cyclotron Resonance</h3>
<p>Let us describe the particle velocity with <span class="math inline">(v_{\perp}, v_{\parallel}, \phi)</span> where <span class="math inline">\phi</span> is the gyrophase. From the equation of motion, we have <span class="math display">
\begin{cases}
\dfrac{d v_{\perp}}{dt} = -
\left( v_{\parallel} - \frac{\omega}{k} \right) \Omega_{w} \sin \zeta
\\
\dfrac{d v_{\parallel}}{dt} =
v_{\perp} \Omega_{w} \sin \zeta
\\
\dfrac{d \zeta}{dt} = -
k \left( v_{\parallel} - v_{R} \right) +
\left( \omega - k v_{\parallel} \right) \frac{\Omega_{w}}{k v_{\perp}} \cos \zeta
\end{cases},
</span> where <span class="math inline">\zeta = \phi - \psi</span> is the relative phase and <span class="math inline">\Omega_w = q B_2 / m c</span>, <span class="math inline">\Omega_{0} = q B_0 / m c</span>, <span class="math inline">v_{R} = (\omega + \Omega_0) / k</span>. Note that both <span class="math inline">\Omega_w</span> and <span class="math inline">\Omega_0</span> include signs.</p>
<p>We see that the cyclotron resonance condition is given by: <span class="math display">
\omega - k v_{\parallel} = -\Omega_{0}
</span> - If the wave amplitude is small <span class="math inline">\Omega_{w}/k v_{\perp} \ll 1</span>, the relative phase is constant over time if <span class="math inline">v_{\parallel} = v_{R}</span>, indicating a resonance between the wave and the particle’s cyclotron motion. - The resonance occurs when the Doppler shifted frequency seen by the particle is equal to the cyclotron motion. (Notice that we have defined that <span class="math inline">\omega &gt; 0</span> is a R-mode.)</p>
</section>
<section class="slide level0">

<h3 data-number="2.3.3" id="constants-of-motion"><span class="header-section-number">2.3.3</span> Constants of Motion</h3>
<p>Direct substitutions confirm that the following two quantities are constants of motion <span class="math display">
\begin{aligned}
&amp; \epsilon =
\frac{1}{2} m \left( v_{\parallel} - \frac{\omega}{k} \right)^2 +
\frac{1}{2} m v_{\perp}^2
\\
&amp; \chi =
\frac{1}{2} m \left( v_{\parallel} - v_{\rm R} \right)^2 -
\frac{m \Omega_w v_{\perp}}{k} \cos \zeta
\end{aligned}
</span> which describe characteristics of pitch-angle scattering even with a finite amplitude wave.</p>
<p><img data-src="figures/scattering1.png" height="350"></p>
</section>
<section class="slide level0">

<h3 data-number="2.3.4" id="momentum-space-diffusion"><span class="header-section-number">2.3.4</span> Momentum-space Diffusion</h3>
<!-- _header: Ref: Terasawa (1989), Karimabadi+ (1992) -->
<p><img data-src="figures/scattering2.png" height="600"></p>
</section>
<section class="slide level0">

<p>Particle transport in the presence of waves may be described by <span class="math display">
\frac{\partial}{\partial t} f +
\boldsymbol{v} \cdot \frac{\partial}{\partial \boldsymbol{x}} f =
\frac{\partial}{\partial \mu}
\left(
    (1 - \mu^2) D_{\mu\mu} \frac{\partial f}{\partial \mu}
\right) +
\frac{1}{p^2} \frac{\partial}{\partial p}
\left(
    p^2 D_{pp} \frac{\partial f}{\partial p}
\right)
</span> where <span class="math inline">\mu = \cos \theta</span> is the pitch angle cosine.</p>
<p>The diffusion coefficients are calculated by <span class="math display">
\begin{aligned}
&amp; D_{\mu\mu} =
\left&lt; \frac{\Delta \theta^2}{2 \Delta t} \right&gt;
\quad \text{or} \quad
(1 - \mu^2) D_{\mu\mu} =
\left&lt; \frac{\Delta \mu^2}{2 \Delta t} \right&gt;
\\
&amp; D_{pp} =
\left&lt; \frac{\Delta p^2}{2 \Delta t} \right&gt;
\sim D_{\mu\mu} \left( \frac{V_{\rm A}}{v} \right)^2
\end{aligned}
</span> where <span class="math inline">\Delta \theta</span> and <span class="math inline">\Delta p</span> are random changes of momentum per scattering in pitch angle and radial momentum, respectively. Repeat scatterings result in diffusion in momentum.</p>
<p>The diffusion in energy is negligible for sufficiently high-energy particles with <span class="math inline">V_{\rm A}/v \ll 1</span>. Quasi-linear theory relates the fluctuation wave power and <span class="math inline">D_{\mu\mu}</span> via: <span class="math display">
D_{\mu\mu} = \frac{\pi}{4} \frac{k_{\rm R} P(k_{\rm R})}{B_0^2} \Omega_0
\quad {\rm where} \quad
k_{\rm R} = \Omega_0 / v \mu
</span></p>
<!-- _header: Ref: Skilling (1975), Blandford & Eichler (1987) -->
</section>
<section class="slide level0">

<h3 data-number="2.3.5" id="spatial-diffusion"><span class="header-section-number">2.3.5</span> Spatial Diffusion</h3>
<p>Let us consider a 1D system along B-field. The pitch-angle diffusion equation in the laboratory frame is given by <span class="math display">
\frac{\partial}{\partial t} f +
(V + v \mu) \frac{\partial}{\partial x} f =
\frac{\partial}{\partial \mu}
\left(
    (1 - \mu^2) D_{\mu\mu} \frac{\partial f}{\partial \mu}
\right),
</span> where <span class="math inline">(v, \mu)</span> are defined in the fluid rest frame and we have assumed <span class="math inline">V \ll v</span>.</p>
<p>Expanding the distribution function using Legendre polynomials: <span class="math display">
f(v, \mu) = f_0(v) + \frac{1}{2} \mu f_1(v) + O(\mu^2),
</span> where weak anisotropy <span class="math inline">f_1 / f_0 \sim 1/D_{\mu\mu} \sim O(\epsilon) \ll 1</span> is assumed. To leading order, we obtain the diffusion-convection equation for the isotropic part of the distribution function <span class="math inline">f_0(x)</span>: <span class="math display">
\frac{\partial}{\partial t} f_0 +
u \frac{\partial}{\partial x} f_0 =
\frac{\partial}{\partial x}
\left[
    \frac{v^2}{6 D_{\mu\mu}} \frac{\partial}{\partial x} f_0
\right] =
\frac{\partial}{\partial x}
\left[
    \kappa \frac{\partial}{\partial x} f_0
\right],
</span> where <span class="math inline">\kappa = v^2/(6 D_{\mu\mu})</span> is the spatial diffusion coefficient.</p>
<!-- _header: Ref: G. P. Zank, Transport Processes in Space Physics and Astrophysics -->
</section>
<section class="slide level0">

<h3 data-number="2.3.6" id="galactic-cosmic-rays-and-solar-activity"><span class="header-section-number">2.3.6</span> Galactic Cosmic Rays and Solar Activity</h3>
<p><img data-src="figures/gcr-sunspot.png" height="600"></p>
<div class="quarto-auto-generated-content">
<div class="footer footer-default">
<p>Space Plasma Physics I (T. Amano)</p>
</div>
</div>
</section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="chap02_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="chap02_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="chap02_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="chap02_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="chap02_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="chap02_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="chap02_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src="chap02_files/libs/revealjs/plugin/search/search.js"></script>
  <script src="chap02_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: false,

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'fade',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1280,

        height: 720,

        // Factor of the display size that should remain empty around the content
        margin: 5.0e-2,

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const onCopySuccess = function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      }
      const getTextToCopy = function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
        text: getTextToCopy
      });
      clipboard.on('success', onCopySuccess);
      if (window.document.getElementById('quarto-embedded-source-code-modal')) {
        // For code content inside modals, clipBoardJS needs to be initialized with a container option
        // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
        const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
          text: getTextToCopy,
          container: window.document.getElementById('quarto-embedded-source-code-modal')
        });
        clipboardModal.on('success', onCopySuccess);
      }
        var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
        var mailtoRegex = new RegExp(/^mailto:/);
          var filterRegex = new RegExp('/' + window.location.host + '/');
        var isInternal = (href) => {
            return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
        }
        // Inspect non-navigation links and adorn them if external
     	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
        for (var i=0; i<links.length; i++) {
          const link = links[i];
          if (!isInternal(link.href)) {
            // undo the damage that might have been done by quarto-nav.js in the case of
            // links that we want to consider external
            if (link.dataset.originalHref !== undefined) {
              link.href = link.dataset.originalHref;
            }
          }
        }
      function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
        const config = {
          allowHTML: true,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start',
        };
        if (contentFn) {
          config.content = contentFn;
        }
        if (onTriggerFn) {
          config.onTrigger = onTriggerFn;
        }
        if (onUntriggerFn) {
          config.onUntrigger = onUntriggerFn;
        }
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note) {
            return note.innerHTML;
          } else {
            return "";
          }
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>